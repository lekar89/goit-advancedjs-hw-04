{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '46506725-7d59e0c0fb37faa107be781d3';\n\nasync function getPhotos(query, page, perPage) {\n  try {\n    const response = await axios.get(`${BASE_URL}`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n      },\n    });\n\n    // Проверяем статус ответа\n    if (response.status !== 200) {\n      throw new Error(response.status);\n    }\n\n    // Возвращаем массив изображений\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n\nexport { getPhotos };\n","function renderGalleryMarkup(images) {\n  return images\n    .map(image => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = image;\n      return `\n            <li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                    <img class=\"gallery-image\" src=\"${webformatURL}\" data-source=\"${largeImageURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                </a>\n                <div class=\"info\">\n                    <p class=\"info-item\">\n                        <b>Likes</b>\n                        ${likes}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b>\n                        ${views}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b>\n                        ${comments}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b>\n                        ${downloads}\n                    </p>\n                </div>\n            </li>\n            `;\n    })\n    .join('');\n}\n\nexport { renderGalleryMarkup };\n","import { getPhotos } from './js/pixabay-api';\nimport { renderGalleryMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Создаем экземпляр SimpleLightbox для элементов галереи\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt', // Указываем, что подписи будут взяты из атрибута \"alt\" изображений\n  captionDelay: 250, // Задержка перед показом подписи (в миллисекундах)\n});\n\n\nlet searchQuery = '';\nlet page = 1;\nconst perPage = 15; // Количество изображений на одной странице\n\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryElement = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\n// Изначально скрываем кнопку \"Load More\"\nloadMoreBtn.style.display = 'none';\n\n// Добавляем обработчик событий на форму поиска, который срабатывает при отправке формы\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault(); // Предотвращаем перезагрузку страницы\n  searchQuery = document.querySelector('#search-box').value.trim(); // Получаем и очищаем запрос пользователя\n  page = 1; // Сбрасываем счетчик страниц\n\n  // Проверяем, ввел ли пользователь запрос\n  if (searchQuery === '') {\n  \n    iziToast.error({\n      message: 'Please enter a search query!', \n      position: 'topRight', \n      timeout: 3000, \n    });\n    return; \n  }\n\n  // Показываем индикатор загрузки и скрываем кнопку \"Load More\"\n  loaderElement.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n\n  try {\n    \n    const data = await getPhotos(searchQuery, page, perPage);\n    galleryElement.innerHTML = ''; // Очищаем галерею перед новым поиском\n\n    // Если фотографии не найдены, выводим сообщение об ошибке\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, no images found. Please try again!',\n        position: 'topRight',\n        timeout: 3000,\n      });\n      return; \n    }\n\n    // Рендерим полученные изображения в галерею\n    galleryElement.innerHTML = renderGalleryMarkup(data.hits);\n    lightbox.refresh(); // Обновляем SimpleLightbox для новых изображений\n\n    // Показываем кнопку \"Load More\" только если количество полученных изображений равно количеству на странице\n    if (data.hits.length === perPage) {\n      loadMoreBtn.style.display = 'block';\n    }\n  } catch {\n    iziToast.error({\n      message: 'Sorry, something went wrong. Please try again!',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  } finally {\n    // Скрываем индикатор загрузки\n    loaderElement.style.display = 'none';\n  }\n});\n\n// Добавляем обработчик событий на кнопку \"Load More\", который срабатывает при нажатии на кнопку\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1; \n\n  try {\n    // Выполняем запрос на получение следующей страницы фотографий\n    const data = await getPhotos(searchQuery, page, perPage);\n\n    // Добавляем новые изображения в галерею\n    galleryElement.insertAdjacentHTML(\n      'beforeend',\n      renderGalleryMarkup(data.hits)\n    );\n    lightbox.refresh(); // Обновляем SimpleLightbox для новых изображений\n\n    // Если количество изображений меньше чем perPage или достигнут конец результатов, скрываем кнопку\n    if (\n      data.hits.length < perPage ||\n      galleryElement.children.length >= data.totalHits\n    ) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 3000,\n      });\n    }\n\n    // Плавное прокручивание страницы вниз после загрузки новых изображений\n    const { height: cardHeight } =\n      galleryElement.firstElementChild.getBoundingClientRect(); // Получаем высоту первого элемента\n    window.scrollBy({\n      top: cardHeight * 2, // Прокручиваем на высоту двух изображений\n      behavior: 'smooth', // Плавная прокрутка\n    });\n  } catch {\n    iziToast.error({\n      message: 'Sorry, something went wrong. Please try again!',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  }\n});\n"],"names":["BASE_URL","API_KEY","getPhotos","query","page","perPage","response","axios","error","renderGalleryMarkup","images","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","searchQuery","searchForm","galleryElement","loaderElement","loadMoreBtn","event","iziToast","data","cardHeight"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAEhB,eAAeC,EAAUC,EAAOC,EAAMC,EAAS,CAC7C,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,GAAGP,CAAQ,GAAI,CAC9C,OAAQ,CACN,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAUC,CACX,CACP,CAAK,EAGD,GAAIC,EAAS,SAAW,IACtB,MAAM,IAAI,MAAMA,EAAS,MAAM,EAIjC,OAAOA,EAAS,IACjB,OAAQE,EAAO,CACd,cAAQ,MAAM,yBAA0BA,CAAK,EACvCA,CACP,CACH,CC9BA,SAASC,EAAoBC,EAAQ,CACnC,OAAOA,EACJ,IAAIC,GAAS,CACZ,KAAM,CACJ,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGP,EACJ,MAAO;AAAA;AAAA,gDAEmCE,CAAa;AAAA,sDACPD,CAAY,kBAAkBC,CAAa,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,0BAKrFC,CAAK;AAAA;AAAA;AAAA;AAAA,0BAILC,CAAK;AAAA;AAAA;AAAA;AAAA,0BAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,0BAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,aAKnC,CAAK,EACA,KAAK,EAAE,CACZ,CC/BA,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAGD,IAAIC,EAAc,GACdjB,EAAO,EACX,MAAMC,EAAU,GAGViB,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAiB,SAAS,cAAc,UAAU,EAClDC,EAAgB,SAAS,cAAc,SAAS,EAChDC,EAAc,SAAS,cAAc,YAAY,EAGvDA,EAAY,MAAM,QAAU,OAG5BH,EAAW,iBAAiB,SAAU,MAAMI,GAAS,CAMnD,GALAA,EAAM,eAAc,EACpBL,EAAc,SAAS,cAAc,aAAa,EAAE,MAAM,OAC1DjB,EAAO,EAGHiB,IAAgB,GAAI,CAEtBM,EAAS,MAAM,CACb,QAAS,+BACT,SAAU,WACV,QAAS,GACf,CAAK,EACD,MACD,CAGDH,EAAc,MAAM,QAAU,QAC9BC,EAAY,MAAM,QAAU,OAE5B,GAAI,CAEF,MAAMG,EAAO,MAAM1B,EAAUmB,EAAajB,EAAMC,CAAO,EAIvD,GAHAkB,EAAe,UAAY,GAGvBK,EAAK,KAAK,SAAW,EAAG,CAC1BD,EAAS,MAAM,CACb,QAAS,4CACT,SAAU,WACV,QAAS,GACjB,CAAO,EACD,MACD,CAGDJ,EAAe,UAAYd,EAAoBmB,EAAK,IAAI,EACxDT,EAAS,QAAO,EAGZS,EAAK,KAAK,SAAWvB,IACvBoB,EAAY,MAAM,QAAU,QAElC,MAAU,CACNE,EAAS,MAAM,CACb,QAAS,iDACT,SAAU,WACV,QAAS,GACf,CAAK,CACL,QAAY,CAERH,EAAc,MAAM,QAAU,MAC/B,CACH,CAAC,EAGDC,EAAY,iBAAiB,QAAS,SAAY,CAChDrB,GAAQ,EAER,GAAI,CAEF,MAAMwB,EAAO,MAAM1B,EAAUmB,EAAajB,EAAMC,CAAO,EAGvDkB,EAAe,mBACb,YACAd,EAAoBmB,EAAK,IAAI,CACnC,EACIT,EAAS,QAAO,GAIdS,EAAK,KAAK,OAASvB,GACnBkB,EAAe,SAAS,QAAUK,EAAK,aAEvCH,EAAY,MAAM,QAAU,OAC5BE,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,QAAS,GACjB,CAAO,GAIH,KAAM,CAAE,OAAQE,CAAY,EAC1BN,EAAe,kBAAkB,wBACnC,OAAO,SAAS,CACd,IAAKM,EAAa,EAClB,SAAU,QAChB,CAAK,CACL,MAAU,CACNF,EAAS,MAAM,CACb,QAAS,iDACT,SAAU,WACV,QAAS,GACf,CAAK,CACF,CACH,CAAC"}